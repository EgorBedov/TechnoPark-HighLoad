# HW3 (HighLoad App Architecture)

## 1. Выбор темы
Мессенджер

## 2. Определение возможного диапазона нагрузок
* Ежесуточная аудитория 90млн человек ~ ВК
* Ежедневно пользователи отправляют 10млрд сообщений [[1]](https://iz.ru/872421/2019-04-25/chislo-ezhednevnykh-soobshchenii-vkontakte-vyroslo-do-10-mlrd)
* На каждое отправленное сообщение пользователь получает от 1 до 10 сообщений. Помимо этого пользователи загружают чаты при входе в приложение, что происходит несколько раз в день => в среднем на один POST запрос пользователь делает 5 GET запросов, которые могут быть в несколько раз больше отправленного сообщения.

## 3. Выбор планируемой нагрузки как 60% доля рынка России
Из предыдущего пункта делаем вывод, что ВК получает 10млрд * 5/(24 * 60 * 60) = **575к RPS**
Для нашей доли рынка снизим RPS на 40% и получим **345к RPS**

Примем вес одного POST запроса равным:

10 слов * 6 символов * 4 байта = 240 байт

Пример вес одного GET запроса равным в пять раз превышающим POST запрос = 1 кБ


Итоговая нагрузка:

( 240 байт * 345000 * 0.2 + 1кБ * 345000 * 0.8 ) * 8 бит = ( 16 560 000 + 282 624 000 ) * 8 бит = 2,4 Гб/с

## 4. Логическая схема базы данных (без выбора СУБД)
![db_scheme](images/db_scheme.png)

## 5. Физическая системы хранения (конкретные СУБД, шардинг, расчет нагрузки, обоснование реализуемости на основе результатов нагрузочного тестирования)
